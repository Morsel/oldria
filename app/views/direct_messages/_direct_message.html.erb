<% div_for direct_message, :class => css_classes_for_direct_message(direct_message) do %>
  <div class="sender_avatar">
    <%= image_tag direct_message.sender.avatar.url(:thumb) %>
  </div>

  <h4 class="message_title column"><%= title_for_direct_message(direct_message) %></h4>

  <p class="message_body">
    <%= link_to truncate(direct_message.body, :length => 100), direct_message_path(direct_message) %>
  </p>

  <%= render direct_message.attachments %>

  <p class="meta date"><%= direct_message.created_at.to_s(:message_meta) %></p>

  <p class="actions message_actions">
      <%= link_to "reply", direct_message, :class => 'button utility round' %>
      <span class="separator"></span>
      <%= link_to "Go to message", direct_message %>
  </p>

  <% unless direct_message.responses.blank? %>
    <div class="message_replies_link">
      <% link_to  direct_message, :class => 'replies' do %>
        <span class="unread_comments_count"><%= direct_message.descendants_size %></span> replies &raquo;
      <% end %>
    </div>
  <% end %>

  <% unless archived_view? %>
    <a href="#" class="readit"><span>read</span></a>
  <% end %>
<% end # div -%>
