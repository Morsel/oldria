<% title "#{@user.username}'s Profile" %>
<% if current_user == @user  %>

<% content_for :page_actions do -%>
  <%= link_to "Edit Profile", edit_user_path(@user), :class=>'sf-button' %>
<% end -%>

<% end -%>

<div id="user_profile_view" class="box clearfix">
	<div class="name_and_pic span-6">
	  <%= image_tag @user.avatar.url(:small), :width=>'100' %>
	  <h2><%= @user.name %></h2>
    <h3><%= @user.username %></h3>
    <p><% if @user.james_beard_region %>Region: <span><%= @user.james_beard_region.name %></span><br /><% end -%>
      </p>
    <% unless current_user == @user %>
  	  <ul class="user_profile_actions">
    		<li><%= link_to "Message this user", new_user_direct_message_path(@user) %></li>
    		<%- if @following -%>
    		<li class="following"><%= link_to "Stop following this user", following_path(@following), :method => :delete, :class=>'sf-button' %></li>
    		<% else %>
    		<li><%= link_to "Follow this user", followings_path(:friend_id => @user), :method => :post, :class=>'sf-button' %></li>
    		<% end -%>
  	  </ul>
  	<% end -%>
	</div><!--/name_and_pic -->
  

	


	
</div><!--#user_profile_view -->

<div id="user_content">
<% if @latest_statuses -%>
<h3 class="function-bold">Recent Status Updates</h3>
<div class="recent_statuses">
	<% for status in @latest_statuses -%>
	<p class="status" id="status_<%= status.id %>">
		<%= render :partial => 'statuses/status', :locals => { :status => status } %>
	</p>
	<% end %>
	<% if @user.statuses.size > 5 -%>
	  <p>
  	  <%= link_to 'View past status updates', user_statuses_path(@user), :class => 'sf-button' %>
  	</p>
	<% end -%>
</div><!-- .box -->
<% else %>
<h4><%= @user.username %> hasn't posted any statuses yet.</h4>
<% end #if -%>

<% if !@user.followings.blank? %>
<div class="span-6">
	<h3 class="function-bold">Following</h3>
	<ul>
		<% for following in @user.followings %>
		<li class="clearfix<%= cycle(' odd',' even') %>">
			<%= link_to image_tag(following.friend.avatar.url(:thumb), :width=>'50',:height=>'50'), profile_path(following.friend.username) %>
			<h4><%= link_to following.friend.name, profile_path(following.friend.username) %></h4>
			<p class="meta">Username: <%= following.friend.username %><br />
			  Region: <%= following.friend.james_beard_region.name %></p>
			<% if (current_user == @user) %>
			  <p><%= link_to "Stop following this user", following, :method => :delete, :class=>'sf-button' %></p>
			<% end %>
		</li>
		<% end %>
	</ul>
</div> <!-- .span-6 -->
<% end #if %>


<% if !@user.followers.blank? %>
<div class="span-6 last">
	<h3 class="function-bold">Followers</h3>
	<ul>
		<% for follower in @user.followers %>
		<li class="clearfix<%= cycle(' odd',' even') %>">
			<%= link_to image_tag(follower.avatar.url(:thumb), :width=>'50', :height=>'50'), profile_path(follower.username) %>
			<h4><%= link_to follower.name, profile_path(follower.username) %></h4>
			<% unless (current_user == follower) || current_user.following?(follower) %>
			<p><%= link_to "Follow this user", followings_path(:friend_id => follower), :method => :post, :class=>'sf-button' %></p>
			<% end %>
		</li>
		<% end %>
	</ul>
</div> <!-- .span-6 -->
<% end %>

</div><!--#user_content-->