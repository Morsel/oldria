<% button_text = @user.new_record? ? "Signup" : "Save" -%>
<% url = @user.new_record? ? mediafeed_media_users_path : mediafeed_media_user_path -%>
<% semantic_form_for @user, :url => url, :html => { :id => 'mediafeed_user' } do |f| %>
<%= error_messages_for :media_user %>
<% f.inputs :name => 'Your Information', :class => 'editing basics' do %>
	<%= f.input :first_name, :input_html => {:class => 'span-3'}, :wrapper_html => {:class => 'span-3'} %>
	<%= f.input :last_name, :input_html => {:class => 'span-4'}, :wrapper_html => {:class => 'span-4'} %>
	<%= f.input :email, :wrapper_html => {:class => 'clear'} %>
	<%= f.input :publication, :label => "Affiliated Publication", :hint => "Please note: your response rate will increase exponentially if you include a publication. If none is listed, chefs will assume you are a <em>diner</em> and not a <em>journalist</em>. If you are <em>freelance</em>, please include your primary publication(s). " %>
	<p>&nbsp;</p>
	<h3>Location(s) that I write for:</h3>
	<p><%= f.input :national, :label => 'I would like to receive a national newsletter to keep abreast of national trends' %></p>
<li>
 <fieldset>
<legend class="label">
<label for="user_metropolitan_areas">I would like to receive local information for the following metro areas (check all that apply)</label>
</legend>
</li>

  <%= select("metropolitan_areas_state","state_id",options_for_select(MetropolitanArea.find(:all,:group=>"state",:conditions=>["state IS NOT NULL"]).map { |r| [r.state, r.state] },(@user.metropolitan_areas.first.state if !@user.metropolitan_areas.first.nil?)),{:include_blank => 'Select a state'}) %>

  <div id="metropolitan_areas_state_cities" style="min-height:45px">
  	<% if(!@user.metropolitan_areas.first.nil?)%>
	  	<%= f.input :metropolitan_areas, :as => :check_boxes, :label => 'I would like to receive local information for the following metro areas (check all that apply)',:collection => MetropolitanArea.find_all_by_state(@user.metropolitan_areas.first.state).map{|e| [e.name,e.id]} %>
	  <% end -%>
  </div>

	<%#=f.input :metropolitan_areas, :as => :check_boxes, :label => 'I would like to receive local information for the following metro areas (check all that apply)' %>
<% end %>
<% f.inputs :name => 'Desired Login Information', :class => 'editing basics' do %>
	<%= f.input :username, :required => true, :input_html => {:autocomplete => "off"} %>
	<%= f.input :password, :required => true, :input_html => {:autocomplete => "off"} %>
	<%= f.input :password_confirmation, :required => true, :input_html => {:autocomplete => "off"} %>
	<div id="requirement_errors"></div>
	<p>
  	<%= button_tag button_text, :class => 'positive' %>
  </p>
<% end %>


<% end %>

