<% title "Search for \"#{truncate(@key, :length => 35)}\"", true %>

<section id="questions-list">
  <% if @trend_questions_found.empty? && @qotds_found.empty? && @comments.empty? %>
    <p>Nothing found.</p>
  <% else %>
    <% unless @trend_questions_found.empty? %>
      <div id="questions-list-feed-trend">
        <h1>Trend Questions</h1>
        <%= render :partial => 'trend_list', :locals => {:questions => @trend_questions_found} %>
      </div>
    <% end %>

    <% unless @qotds_found.empty? %>
      <div id="questions-list-feed-qotd">
        <h1>Questions of the Day</h1>
        <%= render :partial => 'qotd_list', :locals => {:questions => @qotds_found} %>
      </div>
    <% end %>

    <% unless @comments.empty? %>
      <div>
        <h1>Comments</h1>
        <ul>
          <% @comments.each do |comment, question| %>
            <li>
              <% link_to soapbox_soapbox_entry_path(question.soapbox_entry) do %>
                <% date = question.scheduled_at %>
                <time datetime="<%= date.try(:strftime,'%Y-%m-%d') %>"><span><%= date.try(:strftime, "%b").upcase %></span><%= date.try(:strftime, "%e") %></time>
                <span class="title"><%= comment.comment %></span>
                <span class="reply-count"><span><%= count = question.soapbox_comment_count %></span><%= count > 1 ? "replies" : "reply" %></span>
              <% end %>
            </li>
          <% end %>
        </ul>
      </div>
    <% end %>

  <% end %>
</section>
